<!DOCTYPE html>
<html lang="zxx">

<head>
    <title>Webgex - Solução que funciona</title>
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon-16x16.png">

    <!-- Meta tag Keywords -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8" />
    <meta name="keywords" content="Webgex, ERP, CRM, PDV, API, DFI, Bussines Inteligence, BI" />
    <!-- //Meta tag Keywords -->

    <!-- Custom-Files -->
    <link rel="stylesheet" href="assets/css/bootstrap.css">
    <!-- Bootstrap-Core-CSS -->
    <link rel="stylesheet" href="assets/css/style.css" type="text/css" media="all" />
    <link rel="stylesheet" href="assets/css/sobre.css" type="text/css" media="all" />
    <link rel="stylesheet" href="assets/css/slider.css" type="text/css" media="all" />

    <!-- Style-CSS -->
    <!-- font-awesome-icons -->
    <link href="assets/css/fontawesome-all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- //font-awesome-icons -->
    <!-- /Fonts -->
    <link
        href="//fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i"
        rel="stylesheet">
    <!-- //Fonts -->

    <style>
        /* Ajuste geral para textos de erro */
        .error {
            color: red;
            font-size: 0.9em;
            display: none;
        }

        /* Tooltip customizado */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Ajustes para o contêiner de PDF */
        #container-pdf {
            width: 100%;
            max-width: 700px;
            margin: 20px auto;
            margin-left: 50px;
            margin-bottom: 350px;
        }

        #pdfPreview {
            width: 100%;
            height: 700px;
        }

        /* Estilos para o modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: #fff;
            margin: 10% auto;
            padding: 20px;
            width: 90%;
            max-width: 600px;
            border-radius: 10px;
            position: relative;
        }

        .close {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 30px;
            color: #000;
            cursor: pointer;
        }

        /* Responsividade */
        @media (max-width: 768px) {

            /* Esconde o iframe de visualização em dispositivos móveis */
            #container-pdf {
                display: none;
            }

            /* Ajusta o modal para ocupar mais da tela em dispositivos móveis */
            .modal-content {
                width: 90%;
                height: 80%;
            }

            #pdfPreview {
                min-height: 400px;
            }

            .d-flex {
                display: flex;

            }

            .container {
                flex-direction: column;
                align-items: center;
            }

            h1,
            h2 {
                font-size: 1.5em;
                text-align: center;
            }

            /* Espaçamento e ajuste para checkboxes */
            .form-group {
                padding: 10px;
                width: 100%;
            }

            #formContainer {
                width: 90%;
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>


</head>

<body>
    <!-- ======= Header ======= -->
    <header id="header" class="header fixed-top">
        <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
            <div class="logoDetalhes">
                <a href="index.html" class="">
                    <img src="assets/img/Logo.png" alt="Logo da empresa" class="img-fluid">
                    <!-- <span>FlexStart</span> -->
                </a>
            </div>

            <nav id="navbar" class="navbar">
                <ul>
                    <li><a class="nav-link scrollto active" href="index.html#hero">Início</a></li>

                    <li><a class="nav-link scrollto" href="index.html#services">Funcionalidades</a></li>
                    <li><a class="nav-link scrollto" href="index.html#segment">Verticais</a></li>
                    <li><a class="nav-link scrollto" href="#pricing">Preço</a></li>
                    <!-- <li><a class="nav-link scrollto" href="#team">Time</a></li> -->
                    <li><a class="nav-link scrollto" href="#faq">FAQ</a></li>


                    <!-- <li class="dropdown"><a href="#"><span>Drop Down</span> <i class="bi bi-chevron-down"></i></a>
				<ul>
				  <li><a href="#">Drop Down 1</a></li>
				  <li class="dropdown"><a href="#"><span>Deep Drop Down</span> <i class="bi bi-chevron-right"></i></a>
					<ul>
					  <li><a href="#">Deep Drop Down 1</a></li>
					  <li><a href="#">Deep Drop Down 2</a></li>
					  <li><a href="#">Deep Drop Down 3</a></li>
					  <li><a href="#">Deep Drop Down 4</a></li>
					  <li><a href="#">Deep Drop Down 5</a></li>
					</ul>
				  </li>
				  <li><a href="#">Drop Down 2</a></li>
				  <li><a href="#">Drop Down 3</a></li>
				  <li><a href="#">Drop Down 4</a></li>
				</ul>
			  </li> -->

                    <!-- <li class="dropdown megamenu"><a href="#"><span>Mega Menu</span> <i class="bi bi-chevron-down"></i></a>
				<ul>
				  <li>
					<a href="#">Column 1 link 1</a>
					<a href="#">Column 1 link 2</a>
					<a href="#">Column 1 link 3</a>
				  </li>
				  <li>
					<a href="#">Column 2 link 1</a>
					<a href="#">Column 2 link 2</a>
					<a href="#">Column 3 link 3</a>
				  </li>
				  <li>
					<a href="#">Column 3 link 1</a>
					<a href="#">Column 3 link 2</a>
					<a href="#">Column 3 link 3</a>
				  </li>
				  <li>
					<a href="#">Column 4 link 1</a>
					<a href="#">Column 4 link 2</a>
					<a href="#">Column 4 link 3</a>
				  </li>
				</ul>
			  </li> -->


                    <li><a href="blog.html">Blog</a></li>
                    <li><a class="nav-link scrollto" href="sobre.html">Quem somos</a></li>
                    <li><a class="nav-link scrollto" href="index.html#contact">Contato</a></li>
                    <li><a class="getstarted scrollto" href="https://app.webgex.com.br/">Acesse ERP</a></li>
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav><!-- .navbar -->

        </div>
    </header><!-- End Header -->


    <section class="services py-5" id="services">
        <div class="container d-flex justify-content-center align-items-center vh-100 mt-5">
            <div id="formContainer">
                <h1 class="text-center">Formulário de Proposta Comercial</h1>
                <form id="propostaForm" class="needs-validation" novalidate onsubmit="calcularProposta(event)">
                    <!-- action="mail.php" method="post" -->
                    <div class="form-group mt-3">
                        <label for="nome">Nome:</label>
                        <input type="text" class="form-control" id="nome" placeholder="Digite o seu nome e sobrenome"
                            required data-toggle="tooltip" data-placement="right" title="">
                        <div class="invalid-feedback">
                            Este campo é obrigatório.
                        </div>

                    </div>
                    <div class="form-group ">
                        <label for="email">Email</label>
                        <input type="text" class="form-control" id="email" placeholder="Digite o seu email" required
                            data-toggle="tooltip" data-placement="right" title="">
                        <div class="invalid-feedback">
                            Este campo é obrigatório.
                        </div>
                        <div class="error" id="email-error">Por favor, insira um e-mail válido.</div>

                    </div>
                    <div class="form-group ">
                        <label for="telefone">Telefone</label>
                        <input type="text" class="form-control" id="telefone"
                            placeholder="Digite o seu número de telefone" required data-toggle="tooltip"
                            data-placement="right">
                        <div class="invalid-feedback">
                            Este campo é obrigatório.
                        </div>
                        <div class="error" id="telefone-error">Por favor, insira um número de telefone válido.</div>
                    </div>
                    <div class="form-group">
                        <label for="numUsu">Número de Usuários:</label>
                        <span data-toggle="tooltip" data-placement="right"
                            title=" Adicione o número de usuários necessários para utilizar o sistema.">
                            <i class="bi bi-info-circle"></i>
                        </span>
                        <input type="number" class="form-control" id="numUsu" placeholder="Digite o número de Usuários"
                            required data-toggle="tooltip" data-placement="right" oninput="calcularProposta()" min="1">
                        <div class="invalid-feedback">
                            Este campo é obrigatório.
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="numPdvs">Número de PDVs:</label>
                        <span data-toggle="tooltip" data-placement="right"
                            title="PDV (Ponto de Venda) refere-se ao equipamento de caixa da empresa. Adicione o número de PDVs necessários para o seu negócio.">
                            <i class="bi bi-info-circle"></i>
                        </span>
                        <input type="number" class="form-control" id="numPdvs" placeholder="Digite o número de PDVs"
                            required data-toggle="tooltip" data-placement="right" oninput="calcularProposta()" min="0">
                        <div class="invalid-feedback">
                            Este campo é obrigatório.
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="numPacotes">Número de Pacotes de Imagens:</label>
                        <span data-toggle="tooltip" data-placement="right"
                            title="Se a empresa optar por anexar documentos ou fotos, como catálogos digitais ou integração com sites de e-commerce, haverá uma cobrança com base no espaço utilizado. Cada pacote de imagens oferece 50GB de armazenamento.">
                            <i class="bi bi-info-circle"></i>
                        </span>
                        <input type="number" class="form-control" id="numPacotes"
                            placeholder="Digite o número de pacotes" required data-toggle="tooltip"
                            data-placement="right" oninput="calcularProposta()" min="0">

                        <div class="invalid-feedback">
                            Este campo é obrigatório.
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="numPaineis">Número de Painéis Inteligentes:</label>
                        <span data-toggle="tooltip" data-placement="right"
                            title="O sistema WEBGEX oferece uma quantidade limitada de painéis (dashboards) gratuitos. Caso precise de painéis personalizados para o seu negócio, será cobrado um valor adicional para o desenvolvimento, armazenamento e processamento.">
                            <i class="bi bi-info-circle"></i>
                        </span>
                        <input type="number" class="form-control" id="numPaineis"
                            placeholder="Digite o número de painéis" required data-toggle="tooltip"
                            data-placement="right" oninput="calcularProposta()" min="0">
                        <div class="invalid-feedback">
                            Este campo é obrigatório.
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="cobrancaInteligente" data-toggle="tooltip" data-placement="right"
                            title="Custo adicional de R$100 para utilizar a cobrança inteligente">Usará Cobrança
                            Inteligente:
                        </label>
                        <span data-toggle="tooltip" data-placement="right"
                            title="A cobrança inteligente facilita o processo de geração de boletos, integrando diretamente o sistema WEBGEX com as instituições bancárias. O boleto é automaticamente registrado no banco e, ao ser pago, é quitado no sistema, eliminando a necessidade de arquivos de remessa e retorno.">
                            <i class="bi bi-info-circle"></i>
                        </span>
                        <div class="container-cnpj d-flex  ">
                            <select class="form-control" id="cobrancaInteligente" style="width: 80px;"
                                onchange="validarCnpj()">
                                <option value="nao">Não</option>
                                <option value="sim">Sim</option>
                            </select>
                            <input type="number" class="form-control" id="numCnpj" placeholder="Digite números de CNPJ"
                                required data-toggle="tooltip" data-placement="right" oninput="calcularProposta()"
                                min="1" disabled>
                        </div>

                    </div>
                    <div class="form-group">
                        <label for="integracaoWhatsapp" data-toggle="tooltip" data-placement="right"
                            title="Custo adicional de R$300 para integração com WhatsApp">Deseja Integração com
                            WhatsApp:
                        </label>
                        <span data-toggle="tooltip" data-placement="right"
                            title="A integração com o WhatsApp é um serviço opcional de mensagens que pode ser configurado conforme sua necessidade. Ele possui um custo de manutenção mensal, sem limite de mensagens.">
                            <i class="bi bi-info-circle"></i>
                        </span>
                        <select class="form-control" id="integracaoWhatsapp" onchange="calcularProposta()">
                            <option value="nao">Não</option>
                            <option value="sim">Sim</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="conciliacaoBancaria" data-toggle="tooltip" data-placement="right"
                            title="Custo adicional de R$200 para realizar a conciliação bancária">Fará Conciliação
                            Bancária:
                        </label>
                        <span data-toggle="tooltip" data-placement="right"
                            title="A conciliação de cartões de crédito é uma integração com serviços de terceiros, que facilita a identificação de recebíveis e o registro automático das taxas no sistema WEBGEX. Ao optar por este serviço, você autoriza o compartilhamento do seu contato com a empresa parceira que realizará a configuração.">
                            <i class="bi bi-info-circle"></i>
                        </span>
                        <select class="form-control" id="conciliacaoBancaria" onchange="calcularProposta()">
                            <option value="nao">Não</option>
                            <option value="sim">Sim</option>
                        </select>
                    </div>

                    <!-- Campo "Total da Proposta" escondido inicialmente -->
                    <div class="form-group" id="totalContainer">
                        <label for="totalProposta">Total da Proposta:</label>
                        <input type="text" class="form-control" id="totalProposta" readonly>
                    </div>

                    <!-- Adiciona o checkbox de consentimento -->
                    <div class="d-flex form-group mt-3">
                        <div style="display: flex; align-items: center;">
                            <input type="checkbox" id="lgpdConsent" required>
                            <label for="lgpdConsent" onclick="document.getElementById('lgpdConsent').click()"
                                style="margin-left: 5px;">
                                Eu concordo com os <a href="link_para_termos_de_privacidade.html" target="_blank">termos
                                    de
                                    privacidade</a> e autorizo o uso dos meus dados de acordo com a LGPD.
                            </label>
                        </div>
                        <div class="error" id="lgpd-error">Por favor, confirme os termos de privacidade .</div>
                        <div class="invalid-feedback">
                            Você deve concordar com os termos de privacidade para continuar.
                        </div>
                    </div>

                    <div class="d-flex form-group mt-3">
                        <div style="display: flex; align-items: center;">
                            <input type="checkbox" id="lgpdPromoConsent">
                            <label for="lgpdPromoConsent" onclick="document.getElementById('lgpdPromoConsent').click()"
                                style="margin-left: 5px;">
                                Eu concordo em receber promoções e novidades da empresa no meu e-mail.
                            </label>
                        </div>
                    </div>

                    <div class="d-flex justify-content-center">
                        <!-- <button type="submit" class="btn btn-primary mt-3">Calcular Proposta</button> -->
                        <button class="btn btn-success" onclick="gerarPDF(event)">Atualizar</button>

                    </div>
                </form>

            </div>


            <div id="container-pdf" style="">
                <h2 class="text-center">Visualização do PDF</h2>
                <iframe id="pdfPreview"></iframe>
            </div>


        </div>

        <!-- Modal -->
        <div id="pdfModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="fecharModal()">&times;</span>
                <h2>Visualização do PDF</h2>
                <iframe id="pdfPreview2" width="100%" height="600px"></iframe>
            </div>
        </div>

    </section>

    <!-- Scripts -->

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    

    <script>

        document.getElementById('totalProposta').value = `R$0,00`
        $(document).ready(function () {
            $('#telefone').mask('(00) 00000-0000');
        });

        // Função de validação do Bootstrap
        (function () {
            'use strict';
            window.addEventListener('load', function () {
                var forms = document.getElementsByClassName('needs-validation');
                Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();

        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });

        // Função de validação
        function validateForm() {
            let isValid = true;

            // Limpar mensagens de erro
            $('.error').hide();

            // Validação do e-mail
            const email = document.getElementById('email').value;
            const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
            if (!emailPattern.test(email)) {
                $('#telefone-error').show();
                isValid = false;
            }
            const lgpdConsent = document.getElementById('lgpdConsent').checked;
            const lgpdPromoConsent = document.getElementById('lgpdPromoConsent').checked;
            if (!lgpdConsent) {
                $('#lgpd-error').show();
                isValid = false;
            }

            // Validação do telefone
            const telefone = document.getElementById('telefone').value;
            const telefonePattern = /^\(\d{2}\) \d{5}-\d{4}$/;  // (99) 99999-9999
            if (!telefonePattern.test(telefone)) {
                $('#email-error').show();
                isValid = false;
            }
            return isValid;
        }

        function calcularProposta() {

            // Definir valores iniciais
            let total = 0; // Valor base da proposta

            // Capturar os valores dos selects

            const numUsu = document.getElementById('numUsu').value;
            const numPdvs = document.getElementById('numPdvs').value;
            const numPacotes = document.getElementById('numPacotes').value;
            const numPaineis = document.getElementById('numPaineis').value;
            const cobrancaInteligente = document.getElementById('cobrancaInteligente').value;
            const numCnpj = document.getElementById('numCnpj').value;
            const integracaoWhatsapp = document.getElementById('integracaoWhatsapp').value;
            const conciliacaoBancaria = document.getElementById('conciliacaoBancaria').value;

            const itens = []

            // Adicionar custos adicionais com base nas seleções
            if (numUsu > 0) {
                total += 175 * numUsu;
                itens.push({
                    idProduto: "S000001",
                    quantidade: parseInt(numUsu),
                    valorUnitario: 0.0,
                    percentualValorDesconto: 0.0,
                    valorDesconto: 0.0,
                    valorTotal: 175 * numUsu
                })
            }
            if (numPdvs > 0) {
                total += 175 * numPdvs;
                itens.push({
                    idProduto: "S000007",
                    quantidade: parseInt(numPdvs),
                    valorUnitario: 0.0,
                    percentualValorDesconto: 0.0,
                    valorDesconto: 0.0,
                    valorTotal: 175 * numPdvs
                })
            }
            if (numPacotes > 0) {
                total += 150 * numPacotes;
                itens.push({
                    idProduto: "S000013",
                    quantidade: parseInt(numPacotes),
                    valorUnitario: 0.0,
                    percentualValorDesconto: 0.0,
                    valorDesconto: 0.0,
                    valorTotal: 150 * numPacotes
                })
            }
            if (numPaineis > 0) {
                total += 25 * numPaineis;
                itens.push({
                    idProduto: "S000009",
                    quantidade: parseInt(numPaineis),
                    valorUnitario: 0.0,
                    percentualValorDesconto: 0.0,
                    valorDesconto: 0.0,
                    valorTotal: 25 * numPaineis
                })
            }
            if (cobrancaInteligente === 'sim') {
                total += 100 * numCnpj;
                itens.push({
                    idProduto: "S000012",
                    quantidade: parseInt(numCnpj),
                    valorUnitario: 0.0,
                    percentualValorDesconto: 0.0,
                    valorDesconto: 0.0,
                    valorTotal: 100 * numCnpj
                })
            }
            if (integracaoWhatsapp === 'sim') {
                total += 300;
                itens.push({
                    idProduto: "S000015",
                    quantidade: 1,
                    valorUnitario: 0.0,
                    percentualValorDesconto: 0.0,
                    valorDesconto: 0.0,
                    valorTotal: 300
                })
            }
            if (conciliacaoBancaria === 'sim') {
                total += 200;
                itens.push({
                    idProduto: "S000014",
                    quantidade: 1,
                    valorUnitario: 0.0,
                    percentualValorDesconto: 0.0,
                    valorDesconto: 0.0,
                    valorTotal: 200.0
                })
            }

            // Atualizar o valor do campo Total da Proposta
            document.getElementById('totalProposta').value = `R$${total}`;
            return { itens, total }
        }

        const { jsPDF } = window.jspdf;

        let isGenerating = false;
        async function gerarPDF(event) {

            // Verifica se já está em execução
            if (isGenerating) return;

            // Seta a flag como verdadeira para evitar duplicidade
            isGenerating = true;

            // Chama a função para gerar o token e, em seguida, envia a proposta
            try {
                if (validateForm()) {
                    const proposta = calcularProposta();
                    const doc = new jsPDF();

                    // Capturar os valores do formulário
                    const nome = document.getElementById('nome').value;
                    const email = document.getElementById('email').value;
                    const telefone = document.getElementById('telefone').value;
                    const numUsu = document.getElementById('numUsu').value;
                    const numPdvs = document.getElementById('numPdvs').value;
                    const numPacotes = document.getElementById('numPacotes').value;
                    const numPaineis = document.getElementById('numPaineis').value;
                    const cobrancaInteligente = document.getElementById('cobrancaInteligente').value;
                    const numCnpj = document.getElementById('numCnpj').value;
                    const integracaoWhatsapp = document.getElementById('integracaoWhatsapp').value;
                    const conciliacaoBancaria = document.getElementById('conciliacaoBancaria').value;
                    const totalProposta = document.getElementById('totalProposta').value;

                    // Adicionar logo no topo
                    const logoImg = new Image();
                    logoImg.src = 'assets/img/Logo.png'; // Substitua pelo caminho correto da logo
                    await new Promise((resolve) => {
                        logoImg.onload = () => {
                            doc.addImage(logoImg, 'PNG', 80, 10, 50, 20); // Centraliza a logo no topo
                            resolve();
                        };
                    });

                    // Título principal
                    doc.setFont("helvetica", "bold");
                    doc.setFontSize(16);
                    doc.text("Transforme sua Gestão Empresarial com a UNIGEX", 105, 40, { align: "center" });

                    // Introdução
                    doc.setFont("helvetica", "normal");
                    doc.setFontSize(12);
                    doc.text("Prezado empresário,", 20, 50);
                    const introducao =
                        "Você está pronto para levar sua empresa ao próximo nível?A UNIGEX traz uma solução completa de ERP que vai revolucionar a forma como você gerencia seu negócio.";

                    doc.text(doc.splitTextToSize(introducao, 170), 20, 55);

                    // Por que escolher a UNIGEX?
                    doc.setFont("helvetica", "bold");
                    doc.setFontSize(14);
                    doc.text("Por que escolher a UNIGEX?", 20, 70);

                    doc.setFont("helvetica", "normal");
                    const textoUnigex = `Somos especialistas em desenvolver e implementar sistemas integrados de gestão que transformam desafios em oportunidades de crescimento. Nossa equipe multidisciplinar de elite inclui analistas de negócio, consultores especializados, desenvolvedores e profissionais de suporte, todos dedicados ao seu sucesso.`;
                    doc.text(doc.splitTextToSize(textoUnigex, 170), 20, 80);

                    // Solução Completa
                    doc.setFont("helvetica", "bold");
                    doc.setFontSize(14);
                    doc.text("Solução Completa para sua Empresa:", 20, 120);

                    const modulos = [
                        "• CRM: Gestão completa do relacionamento com clientes",
                        "• Vendas: Controle total do seu pipeline comercial",
                        "• Financeiro: Gestão precisa das suas finanças",
                        "• Estoque: Controle eficiente dos seus produtos",
                        "• Compras: Otimização do seu processo de aquisição",
                        "• Fiscal: Conformidade total com as obrigações fiscais",
                        "• Contábil: Visão clara da sua saúde financeira, incluindo DRE"
                    ];
                    modulos.forEach((item, index) => {
                        doc.text(item, 20, 130 + index * 7);
                    });


                    // Título para nova página
                    doc.setFont("helvetica", "bold");
                    doc.setFontSize(14);
                    doc.text("Investimento Mensal:", 20, 180);
                    console.log(cobrancaInteligente);
                    doc.setFont("helvetica", "normal");
                    if (cobrancaInteligente == 'sim') {
                        const servicos = [
                            "- Sistema ERP: R$ 175,00 por usuário",
                            "- PDV: R$ 150,00 por máquina",
                            "- Armazenamento em Nuvem: R$ 150,00 por pacotes de 50Gb",
                            "- Cobrança Inteligente: R$150,00 por CNPJ",
                            "- Conciliação BOAVISTA: Parceria direta com fornecedor"
                        ];
                        servicos.forEach((item, index) => {
                            doc.text(item, 20, 190 + index * 7);
                        });
                    } if (cobrancaInteligente == 'nao') {
                        const servicos = [
                            "- Sistema ERP: R$ 175,00 por usuário",
                            "- PDV: R$ 150,00 por máquina",
                            "- Armazenamento em Nuvem: R$ 150,00 por pacotes de 50Gb",
                            "- Cobrança Inteligente: nenhum",
                            "- Conciliação BOAVISTA: Parceria direta com fornecedor"
                        ];
                        servicos.forEach((item, index) => {
                            doc.text(item, 20, 190 + index * 7);
                        });
                    }


                    doc.setFont("helvetica", "bold");
                    doc.text(`Investimento Total: R$ ${Number(proposta.total)}/mês`, 20, 230);

                    // Implantação Personalizada
                    doc.setFontSize(14);
                    doc.text("Implantação Personalizada:", 20, 240);


                    doc.setFont("helvetica", "normal");
                    const textoImplantacao = `O valor da implantação é personalizado de acordo com suas necessidades específicas de treinamento, garantindo que sua equipe aproveite ao máximo todas as funcionalidades do sistema.`;
                    doc.text(doc.splitTextToSize(textoImplantacao, 170), 20, 250);

                    // Adicionar nova página para informações financeiras
                    doc.addPage();

                    // Contato
                    doc.setFont("helvetica", "bold");
                    doc.setFontSize(14);
                    doc.text("Dúvidas? Estamos aqui para ajudar!", 20, 20);

                    doc.setFont("helvetica", "normal");

                    const textoContato = "Entre em contato conosco para um diagnóstico gratuito do seu negócio e descubra como podemos impulsionar seus resultados. Nossa equipe está pronta para esclarecer todas as suas dúvidas e apresentar a solução ideal para sua empresa.";
                    doc.text(doc.splitTextToSize(textoImplantacao, 170), 20, 30);



                    // Adiciona os ícones com textos
                    const contatos = [
                        " •  +55 85 99863-0052", // Ícone de telefone
                        " •  helpdesk@unigex.com.br", // Ícone de email
                        " •  www.webgex.com.br" // Ícone de link
                    ];
                    contatos.forEach((item, index) => {
                        doc.text(item, 20, 60 + index * 7); // Adiciona cada linha no PDF
                    });

                    // Logo no rodapé
                    const logoImgRodape = new Image();
                    logoImgRodape.src = '/assets/img/ugxnova_logo.jpg'; // Substitua pelo caminho correto da logo
                    await new Promise((resolve) => {
                        logoImgRodape.onload = () => {
                            doc.addImage(logoImgRodape, 'PNG', 160, 100, 40, 20);
                            resolve();
                        };
                    });

                    // Gerar o PDF como Blob
                    const pdfBlob = doc.output('blob');
                    console.log(pdfBlob);

                    // Exibição do PDF em dispositivos móveis ou desktop
                    if (window.innerWidth <= 768) {  // Verifica se a tela é um celular
                        const pdfURL = URL.createObjectURL(pdfBlob);
                        const iframe = document.getElementById('pdfPreview2');
                        iframe.src = pdfURL;
                        document.getElementById('pdfModal').style.display = "block"; // Exibe o modal
                    } else {
                        // Para telas maiores, exibe o PDF no outro iframe fora do modal
                        const pdfURL = URL.createObjectURL(pdfBlob);
                        const iframe = document.getElementById('pdfPreview');
                        iframe.src = pdfURL;
                        document.getElementById('container-pdf').style.display = 'block';
                    }

                    
                    // // const wtoken = await gerarToken();
                    // if (!wtoken) throw new Error("Token não gerado");
                    // console.log(proposta.itens)
                    // Prepara os dados do formulário
                    const body = {

                        pedidoCliente: "",
                        codigoVendedor: 72,
                        situacao: "E0",
                        tipo: "PV",
                        valor: proposta.total,
                        dataAbertura: "2024-11-19",
                        horaAbertura: "00:00:00",
                        dataFechamento: "2024-11-25",
                        horaFechamento: "00:00:00",
                        cliente: {
                            nome,
                            email,
                            telefone,
                            endereco: {}
                        },
                        itens: proposta.itens

                    };

                    // URL da API para envio da proposta
                    const baseUrl = "https://api-v2.webgex.com.br";
                    const params = `codigoUnidade=10001`
                    const wurl = `${baseUrl}/erp-oportunidades?${params}`; // ajuste conforme o caminho da sua API
                    const wtoken = "1OAXRCClIdHODuDSErAd1RXZBap2mvCpaTaA9tdtlsI"
                    // Envia a requisição POST com o token no header
                    const response = await fetch(wurl, {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "WGX-API-KEY": `${wtoken}`,
                        },
                        body: JSON.stringify(body),
                    });

                    if (!response.ok) {
                        throw new Error(`Erro na requisição: ${response.statusText} +  detalhes: ${response.detail}`);
                    }

                    const data = await response.json();
                    console.log("Success:", data);
                    // Você pode adicionar um alerta ou outra lógica para confirmar o sucesso

                }
            } catch (error) {
                console.error("Erro ao gerar PDF ou enviar dados:", error);
            } finally {
                isGenerating = false;
            }
        }






        // Função para gerar o token
        // async function gerarToken() {
        //     const baseUrl = "https://webgexapi-v2-stg.for-01.fks.services";
        //     const tokenUrl = `${baseUrl}/oauth/token`;
        //     const USERNAME = "integracao@clidev.com.br";
        //     const PASSWORD = "xpto";
        //     const CLIENT_ID = "Webgex@pdv@CDEV";
        //     const CLIENT_SECRET = "!VEDC@vdp@xegbeW#";
        //     const GRANT_TYPE = "password";

        //     // Gerar o token corretamente com as credenciais de autenticação
        //     const credentials = `${CLIENT_ID}:${CLIENT_SECRET}`;
        //     const encodedCredentials = btoa(credentials); // Codificar em base64

        //     try {
        //         const response = await fetch(tokenUrl, {
        //             method: "POST",
        //             headers: {
        //                 "Content-Type": "application/x-www-form-urlencoded",
        //                 "Authorization": `Basic ${encodedCredentials}`, // Basic Auth no header
        //             },
        //             body: new URLSearchParams({
        //                 username: USERNAME,
        //                 password: PASSWORD,
        //                 grant_type: GRANT_TYPE,
        //             }),
        //         });

        //         if (!response.ok) {
        //             throw new Error(`Erro ao gerar token: ${response.statusText}`);
        //         }

        //         const data = await response.json();


        //         return data.access_token; // Retorna o token
        //     } catch (error) {
        //         console.error("Erro ao obter o token:", error);
        //     }
        // }




        function validarCnpj() {
            const cobrancaInteligente = document.getElementById("cobrancaInteligente").value;
            const numCnpj = document.getElementById("numCnpj");

            if (cobrancaInteligente === "sim") {
                // Habilitar o campo e torná-lo obrigatório
                numCnpj.disabled = false;
                numCnpj.setAttribute("required", "true");
            } else {
                // Desabilitar o campo e remover a obrigatoriedade
                numCnpj.disabled = true;
                numCnpj.removeAttribute("required");
                numCnpj.value = "";  // Limpar o valor do campo quando desabilitado
            }
        }



        // Função para fechar o modal
        function fecharModal() {
            const modal = document.getElementById('pdfModal');
            modal.style.display = "none";  // Esconde o modal
        }

        document.addEventListener("DOMContentLoaded", function () {
            const gerarPdfButton = document.querySelector(".btn-success");
            validarCnpj();
            if (gerarPdfButton) {
                gerarPdfButton.addEventListener("click", function (event) {
                    event.preventDefault();
                    gerarPDF();
                });
            }
        });




    </script>



</body>


<!-- ======= Footer ======= -->
<footer id="footer" class="footer">

    <!-- <div class="footer-newsletter"> -->
    <!-- <div class="container"> -->
    <!-- <div class="row justify-content-center"> -->
    <!-- <div class="col-lg-12 text-center">
					<h4>Our Newsletter</h4>
					<p>Tamen quem nulla quae legam multos aute sint culpa legam noster magna</p>
				  </div> -->
    <!-- <div class="col-lg-6">
					<form action="" method="post">
					  <input type="email" name="email"><input type="submit" value="Subscribe">
					</form>
				  </div> -->
    <!-- </div> -->
    <!-- </div> -->
    <!-- </div> -->

    <div class="footer-top">
        <div class="container">
            <div class="row gy-4">
                <div class="col-lg-6 col-md-12 footer-info">
                    <a href="index.html" class="logo d-flex align-items-center">
                        <img src="assets/img/Logo.png" alt="">

                    </a>
                    <p>26 anos contribuindo seu sucesso <br>
                        Implementamos sistemas de gestão que ajudam a sua empresa a alcançar o sucesso!.</p>
                    <div class="social-links mt-3">
                        <!-- <a href="#" class="twitter"><i class="bi bi-twitter"></i></a> -->
                        <a href="https://www.facebook.com/unigexsolucoes/" class="facebook"><i
                                class="bi bi-facebook"></i></a>
                        <a href="https://www.instagram.com/unigexsolucoes/" class="instagram"><i
                                class="bi bi-instagram"></i></a>
                        <a href="https://www.linkedin.com/company/unigex-solucoes-integradas-de-gestao/about/"
                            class="linkedin"><i class="bi bi-linkedin"></i></a>
                    </div>
                </div>

                <div class="col-lg-3 col-6 footer-links">
                    <h4>Links</h4>
                    <ul>
                        <li><i class="bi bi-chevron-right"></i> <a href="#hero">Início</a></li>
                        <li><i class="bi bi-chevron-right"></i> <a href="#about">Sobre</a></li>
                        <li><i class="bi bi-chevron-right"></i> <a href="#services">Serviços</a></li>
                        <li><i class="bi bi-chevron-right"></i> <a href="#">Termos e serviços</a></li>
                        <li><i class="bi bi-chevron-right"></i> <a href="policy.html">Política de privacidade</a>
                        </li>
                    </ul>
                </div>

                <!-- <div class="col-lg-2 col-6 footer-links">
					<h4>Our Services</h4>
					<ul>
					  <li><i class="bi bi-chevron-right"></i> <a href="#">Web Design</a></li>
					  <li><i class="bi bi-chevron-right"></i> <a href="#">Web Development</a></li>
					  <li><i class="bi bi-chevron-right"></i> <a href="#">Product Management</a></li>
					  <li><i class="bi bi-chevron-right"></i> <a href="#">Marketing</a></li>
					  <li><i class="bi bi-chevron-right"></i> <a href="#">Graphic Design</a></li>
					</ul>
				  </div> -->

                <div class="col-lg-3 col-md-12 footer-contact text-center text-md-start">
                    <h4>Contatos </h4>
                    <p>
                    <p>R. Tibúrcio Cavalcante, 1958 <br> Aldeota, Fortaleza - CE, 60125-100 <br><br>
                        <strong>Fone:</strong> +55 85 9863-0052<br>
                        <strong>Email:</strong> helpdesk@unigex.com.br<br>
                    </p>

                </div>

            </div>
        </div>
    </div>

    <div class="container">
        <div class="copyright">
            &copy; Copyright <strong><span>Unigex</span></strong>.
            Todos os direitos reservados
        </div>
        <div class="credits">
            Designed by <a href="http://unigex.com.br/">Unigex</a>
        </div>
    </div>
</footer><!-- End Footer -->

<a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
        class="bi bi-arrow-up-short"></i></a>

<!-- Vendor JS Files -->
<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="assets/vendor/aos/aos.js"></script>
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>

<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>

</body>

</html>